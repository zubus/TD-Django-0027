## M√≥dulo 6 - Sesiones 5 y 6

### üóÇÔ∏è Estructura del proyecto
```
proyecto1/
    boards/
        static/
            boards/
                img/
                    gatito.png
                    perrito.png
        templates/
            boards/
                base.html
                example.html
                fecha.html
                formulario1.html
                gracias.html
                name.html
        forms.py
        urls.py
        views.py
    proyecto1/
        settings.py
```

### üìù Commits realizados

### üìù [Commit 1: Mostrar fecha actual en una vista](https://github.com/zubus/TD-Django-0027/commit/8c487c0ec4797abacb45faf3e9a696ae02902a74)

En este commit, se a√±adi√≥ una vista en Django para mostrar la fecha actual. Los cambios realizados incluyen:

1. Creaci√≥n del archivo `fecha.html` en la carpeta `boards/templates/boards`. Este archivo contiene el c√≥digo HTML que muestra la fecha actual utilizando la variable `{{ fecha }}`.

2. En `boards/urls.py`, se a√±adi√≥ una nueva ruta que enlaza a la funci√≥n `get_date_view()` en el archivo `boards/views.py`. La ruta es `date/` y su nombre es `"get_date"`.

3. En `boards/views.py`, se defini√≥ la funci√≥n `get_date_view(request)`, que obtiene la fecha actual usando la funci√≥n `datetime.now()` y la pasa al contexto (`context`) como `fecha`. A continuaci√≥n, la funci√≥n `render()` se utiliza para mostrar `fecha.html` con el contexto provisto.

### üìù [Commit 2: A√±adir ejemplo con nombre al mostrar fecha](https://github.com/zubus/TD-Django-0027/commit/16bb68d046b0216cdc944beeacf09022260cbdf9)

En este commit, se actualiz√≥ el ejemplo anterior para incluir un nombre en la URL y mostrar un mensaje de bienvenida con el nombre en `fecha.html`. Los cambios incluyen:

1. Modificaci√≥n de `fecha.html` para agregar un mensaje de bienvenida con la variable `{{ nombre }}`.

2. En `boards/urls.py`, se actualiz√≥ la ruta que enlaza a `get_date_view()` para aceptar una variable `name`. La ruta es ahora `date/<str:name>/` y su nombre sigue siendo `"get_date"`.

3. En `boards/views.py`, la funci√≥n `get_date_view(request, name)` se modific√≥ para aceptar un par√°metro adicional, `name`. Luego, se a√±ade el `name` al contexto y se muestra en `fecha.html`.

### üìù [Commit 3: A√±adir Bootstrap 5 a `fecha.html` y al proyecto](https://github.com/zubus/TD-Django-0027/commit/f3f3854b29ff9735e78bb759ad5909e7cc4f5eee)

Se a√±adi√≥ Bootstrap 5 al proyecto para estilizar `fecha.html`. Los cambios incluyen:

1. Modificaci√≥n de `fecha.html` para cargar e importar las etiquetas necesarias de Bootstrap 5.
2. En el archivo `proyecto1/settings.py`, se a√±adi√≥ la aplicaci√≥n `"bootstrap5"` a la lista de aplicaciones instaladas.

### üìù [Commit 4: A√±adir base.html con navbar y heredar desde `fecha.html`](https://github.com/zubus/TD-Django-0027/commit/e7b910c6de5e4c40badc5a36cae77a4a6ed8b2ca)

En este commit, se introdujo la herencia de templates de Django a√±adiendo un archivo `base.html` con un navbar y luego heredando su estructura desde `fecha.html`. Los cambios incluyen:

1. Creaci√≥n del archivo `base.html` en la carpeta `boards/templates/boards`. Este archivo contiene la estructura base del proyecto, incluyendo la etiqueta de bloque `{% block contenido %}` que permite a otros templates heredar y modificar el contenido de esta secci√≥n.

2. Modificaci√≥n de `fecha.html` para heredar de `base.html` utilizando la etiqueta `{% extends 'boards/base.html' %}` y luego definir su contenido espec√≠fico dentro de un bloque `{% block contenido %}`.

Con estos cambios, hemos implementado el sistema de herencia de templates de Django que permite reutilizar c√≥digo HTML base en diferentes p√°ginas del proyecto, facilitando el mantenimiento y la coherencia visual del sitio web.

### üìù [Commit 5: Agregar ejemplos de filtros y tags](https://github.com/zubus/TD-Django-0027/commit/ee78ebe49b6b4fac504387a93e0267a24c0d0c8f)

En este commit, se agregan ejemplos de filtros y tags en `fecha.html` y `base.html`. Los cambios incluyen:

1. En `base.html`, se a√±ade un bloque de t√≠tulo `{% block titulo %}{% endblock titulo %}` que permite a los templates que heredan de `base.html` personalizar el t√≠tulo de la p√°gina.
   
2. Modificaci√≥n de `fecha.html` para incluir un ejemplo de filtro que convierte el mensaje de bienvenida a may√∫sculas usando `{% filter upper %}` y `{% endfilter %}`.

3. En `fecha.html`, se a√±ade el bloque de prueba `{% block prueba %}` en el que se muestran algunas acciones condicionales como `{% if ... %}`, `{% elif ... %}` y `{% else %}` junto con un ejemplo de bucle `{% for ... %}`.

4. En `views.py`, se importa la funci√≥n `randint` para obtener n√∫meros enteros aleatorios y se a√±aden m√°s variables al contexto para incluir frutas y un n√∫mero aleatorio.

Con estos cambios, hemos demostrado el uso de filtros y tags en Django Template Language, que permite mayor control sobre la presentaci√≥n y manipulaci√≥n de datos en los templates del proyecto.
Puedes encontrar la informaci√≥n sobre filtros y tags en la [Documentaci√≥n de Django](https://docs.djangoproject.com/en/4.2/ref/templates/builtins/) y en [w3schools](https://www.w3schools.com/django/ref_tags_filter.php).

### üìù [Commit 6: Agregar archivos est√°ticos y tag "url" en Django Templates](https://github.com/zubus/TD-Django-0027/commit/e6e200191501691d1b4bbaa2c81493289f44b8c7)

En este commit, se explica c√≥mo agregar archivos est√°ticos en el Django Template, as√≠ como el uso del tag "url". Los cambios realizados incluyen:

1. Se a√±adieron im√°genes de gatito y perrito en la carpeta `proyecto1/boards/static/boards/img/` .

2. Se modific√≥ el archivo `proyecto1/boards/templates/boards/fecha.html` para incluir el uso de im√°genes est√°ticas con la etiqueta `{% static %}`.

3. Se cre√≥ un archivo de ejemplo `proyecto1/boards/templates/boards/example.html`. Este archivo muestra c√≥mo utilizar el objeto `persona` para presentar el nombre y apellido en un template.

4. Se actualiz√≥ el archivo `proyecto1/boards/views.py` para crear una funci√≥n de vista para el archivo `example.html`, que utiliza la clase `Persona` para crear un objeto `persona` con el nombre y apellido, y lo env√≠a como parte del contexto.

5. Se modific√≥ el archivo `proyecto1/boards/urls.py` para agregar una nueva ruta que enlaza a la funci√≥n de vista creada en el paso 4: `example/`, con el nombre `"example"`.

6. Se a√±adi√≥ el tag `{% url %}` en el archivo `proyecto1/boards/templates/boards/fecha.html`, que genera la URL para la vista a la que se dirige el bot√≥n en la tarjeta.

Con estos cambios, ahora se pueden mostrar im√°genes est√°ticas en el template y utilizar el tag "url" para enlazar a otras vistas en el proyecto.

### üìù [Commit 7: A√±adir formularios tanto de manera manual como con `forms.Form`](https://github.com/zubus/TD-Django-0027/commit/6123c1ac9093c691c4a046c7a80017b65dad79f3)

En este commit, se agregan formularios de dos maneras diferentes: manualmente y utilizando la clase `forms.Form` de Django. Los cambios incluyen:

1. Creaci√≥n del archivo `proyecto1/boards/forms.py`:

```python
from django import forms

class NameForm(forms.Form):
    your_name = forms.CharField(label='enter your name:', max_length=100)
    pet = forms.CharField(label='enter pet name:', max_length=100)
    country = forms.CharField(label='enter your country:', max_length=100)
```

En este archivo, se crea una nueva clase `NameForm` que hereda de `forms.Form`. Se definen tres campos de tipo `CharField` con etiquetas y longitudes m√°ximas espec√≠ficas.

2. Creaci√≥n del archivo `proyecto1/boards/templates/boards/formulario1.html`:

```html
{% extends 'boards/base.html' %}

{% block contenido %}
<div class="row">
    <form action="/getname/" method="post">
        {% csrf_token %}
        <label for="your_name">tu nombre: </label>
        <input id="your_name" type="text" name="your_name" value="">
        <input type="submit" value="OK">
    </form>
</div>
{% endblock contenido %}
{% block prueba %}{% endblock prueba %}
```

En este template, se crea un formulario simple de manera manual incluyendo el campo `your_name` y el bot√≥n de env√≠o.

Respecto a `{% csrf_token %}` en el template `formulario1.html`, eso es una etiqueta especial que se utiliza para agregar un token de seguridad CSRF (Cross-Site Request Forgery) al formulario. 

CSRF es una vulnerabilidad que puede permitir a un atacante falsificar una solicitud a un sitio web y realizar acciones no deseadas en nombre del usuario. Django incluye medidas de seguridad para proteger contra esto, y una de ellas es el uso del token CSRF.

Al incluir la etiqueta `{% csrf_token %}` dentro del formulario, se agrega autom√°ticamente un campo oculto con el token CSRF. Esto es necesario para que Django pueda verificar que los formularios enviados provienen de la p√°gina actual y no de un ataque CSRF.

3. Creaci√≥n del archivo `proyecto1/boards/templates/boards/name.html`:

```html
{% extends 'boards/base.html' %}

{% block contenido %}
<form action="/getname/" method="post">
    {% csrf_token %}
    {{ form }}
    <input type="submit" value="Submit">
</form>
{% endblock contenido %}
{% block prueba %}{% endblock prueba %}
```

En este template, se crea un formulario que utiliza `NameForm` para definir y renderizar sus campos autom√°ticamente.

4. Creaci√≥n del archivo `proyecto1/boards/templates/boards/gracias.html`:

```html
{% extends 'boards/base.html' %}
{% block contenido %}
<h1 class="text-success"> Los datos han sido enviados correctamente</h1>
{% endblock contenido %}
{% block prueba %}{% endblock prueba %}
```
Aqu√≠ se muestra un mensaje cuando el formulario ha sido enviado correctamente.

5. Actualizaci√≥n del archivo `proyecto1/boards/urls.py` para agregar rutas necesarias:

```python
from .views import (get_date_view, name_view, mostrar, formulario_nombre,
                    get_name, thanks)

urlpatterns = [
    # ... otras rutas ...
    path("formulario/", formulario_nombre, name="formulario"),
    path("getname/", get_name, name="get_name"),
    path("thanks/", thanks, name="thanks"),
]
```

6. Actualizaci√≥n del archivo `proyecto1/boards/views.py` para agregar las funciones de vistas correspondientes a los nuevos formularios y plantillas:

```python
from .forms import NameForm

# ... otras funciones de vista ...

def formulario_nombre(request):
    return render(request, 'boards/formulario1.html')

def get_name(request):
    if request.method == 'POST':
        form = NameForm(request.POST)
        if form.is_valid():
            return HttpResponseRedirect('/thanks/')
    else:
        form = NameForm()
        context= {'form':form}
        return render(request, 'boards/name.html',context)

def thanks(request):
    return render(request, "boards/gracias.html")
```

Esta funci√≥n de vista maneja las solicitudes (`request`) enviadas al formulario. A trav√©s del m√©todo `POST`, se verifica si el formulario ha sido enviado. 

- Si es una solicitud `POST`, el formulario `NameForm` se crea utilizando los datos enviados (`request.POST`). Luego, se verifica si el formulario es v√°lido mediante el m√©todo `is_valid()`. Si lo es, se redirige al usuario a la p√°gina de agradecimiento (`/thanks/`) utilizando `HttpResponseRedirect`.

- Si es una solicitud `GET` o cualquier otro m√©todo de solicitud, se crea una instancia vac√≠a del formulario `NameForm` y se renderiza el template `'boards/name.html'` junto con el contexto que contiene el formulario.

Con estos cambios, se han implementado dos m√©todos diferentes para crear formularios en Django.

### üìö Conceptos clave

#### 1. Templates

Un template en Django es un archivo HTML que contiene marcado HTML y etiquetas de plantilla propias de Django. Estos templates se utilizan para generar el contenido de un sitio web de manera din√°mica y permiten separar la l√≥gica de presentaci√≥n de la l√≥gica de negocio en una aplicaci√≥n web.

#### 2. Lenguaje de plantillas de Django (DTL)

El Lenguaje de Plantillas de Django (DTL, por sus siglas en ingl√©s) es un sistema de marcado que permite agregar l√≥gica de presentaci√≥n (como bucles y condicionales) y datos din√°micos directamente en el archivo HTML. DTL incluye etiquetas (como `{% for %}`, `{% if %}`) y variables (como `{{ variable }}`) para incluir dicha l√≥gica.

### üõ†Ô∏è C√≥mo utilizar el sistema de templates

#### 1. Renderizaci√≥n de templates

En tu archivo `views.py`, importa la funci√≥n `render()` de Django y crea una funci√≥n de vista que renderiza el template con un contexto espec√≠fico. En el ejemplo de los commits previos se usa el archivo `fecha.html` y la funci√≥n `get_date_view(request, name)`, donde el contexto contiene el nombre y la fecha actual:

```python
from django.shortcuts import render
import datetime

def get_date_view(request, name):
    fecha_actual = datetime.datetime.now()
    context = {
        'fecha': fecha_actual,
        'nombre': name
    }
    return render(request, 'boards/fecha.html', context)
```

#### 2. Conectar la vista con el template mediante la URL

En tu archivo `urls.py`, crea una nueva ruta que apunte a la funci√≥n de vista `get_date_view(request, name)` que acabas de crear. En nuestro ejemplo, la ruta utilizada es `date/<str:name>/`, lo que significa que la URL debe ser seguida por el nombre del usuario. 

```python
from django.urls import path
from .views import get_date_view

urlpatterns = [
    # ... otras rutas ...
    path("date/<str:name>/", get_date_view, name="get_date"),
]
```

De esta manera, al acceder a la URL `date/Nombre`, se renderizar√° `fecha.html` con los datos proporcionados en el contexto.

#### 3. Filtros

Los filtros en Django permiten aplicar transformaciones a las variables dentro de los templates. Por ejemplo, el filtro `upper` transforma una cadena de texto en may√∫sculas y se puede usar de la siguiente manera en un template:

```html
{% filter upper %}
    <h1>Bienvenido {{nombre}}</h1>
{% endfilter %}
```

#### 4. Tags

Los tags en Django son peque√±as piezas de c√≥digo que agregan l√≥gica adicional a los templates sin necesidad de modificar el archivo `views.py`. Ejemplos de tags incluyen `{% if %}`, `{% for %}`, `{% block %}`, entre otros. Estos tags a√±aden estructuras condicionales, bucles y bloques personalizables en los templates.

```html
{% for fruta in frutas %}
    <li>{{fruta}}</li>
{% endfor %}
```

### üõ†Ô∏è C√≥mo agregar filtros, condicionales y bucles a tus templates

1. En tu archivo HTML, coloca el filtro, tag o bucle dentro de las etiquetas del bloque de contenido.

2. Env√≠a las variables requeridas desde la vista como parte del contexto.

3. No olvides proporcionar los datos de prueba en tu vista para poder probar las funcionalidades de los filtros, condicionales y bucles en tus templates.

### üõ†Ô∏è C√≥mo agregar archivos est√°ticos y el tag "url" en tus templates

#### 1. Agregar archivos est√°ticos

Coloca tus archivos est√°ticos (im√°genes, CSS, JavaScript) en una carpeta denominada `static` dentro de la aplicaci√≥n en la que se utilizar√°n. En este ejemplo, se colocaron las im√°genes `gatito.png` y `perrito.png` en la carpeta `proyecto1/boards/static/boards/img/`.

Carga el archivo est√°tico en tu template utilizando `{% load static %}`. Luego, utiliza la etiqueta `{% static 'ruta/al/archivo' %}` para agregar el archivo est√°tico en tu HTML. Por ejemplo:

```html
{% load static %}
<img src="{% static 'boards/img/gatito.png' %}" class="card-img-top" alt="...">
```

#### 2. A√±adir el tag "url" en tu template

Utiliza el tag `{% url 'nombre_de_la_vista' %}` para generar la URL de una vista en tu template. Por ejemplo:

```html
<a href="{% url 'name' %}" class="btn btn-primary">Ir a name</a>
```

Esto generar√° la URL para la vista llamada `name` y crear√° un enlace a la p√°gina correspondiente.

### üîÑ Reutilizaci√≥n y mantenimiento del c√≥digo: Herencia de templates

La herencia de templates en Django es una t√©cnica que permite reutilizar el c√≥digo HTML en diferentes archivos de plantillas. Mediante la creaci√≥n de un archivo de template base (por ejemplo, `base.html`), se pueden definir bloques de contenido que otros templates pueden sobrescribir o extender.
